# ==============================================================================
# ENVIRONMENT SETUP: TESTING vs PRODUCTION
# ==============================================================================
#
# TESTING SETUP (Local with ngrok):
#   - Create a separate test bot with @BotFather (e.g., @your_nutrition_test_bot)
#   - Use GITHUB_BRANCH=daily-logs-test
#   - Use ngrok URL for WEBHOOK_URL
#   - Can run simultaneously with production
#
# PRODUCTION SETUP (Railway):
#   - Use your production bot token
#   - Use GITHUB_BRANCH=daily-logs
#   - Leave WEBHOOK_URL blank (auto-detects from RAILWAY_PUBLIC_DOMAIN)
#   - Set in Railway dashboard environment variables
#
# ==============================================================================

# ==============================================================================
# TELEGRAM CONFIGURATION
# ==============================================================================

# Telegram Bot Token (REQUIRED)
# Get from @BotFather on Telegram
# For testing: Use test bot token
# For production: Use production bot token
TELEGRAM_BOT_TOKEN=your_bot_token_from_botfather

# Webhook URL for Telegram
# For Railway: Leave blank to auto-detect from RAILWAY_PUBLIC_DOMAIN
# For local development: Use ngrok URL (e.g., https://abc123.ngrok-free.app)
WEBHOOK_URL=

# Webhook Secret (REQUIRED IN PRODUCTION)
# Prevents spoofed webhook requests from unauthorized sources
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# Example: d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2c3d4e5
WEBHOOK_SECRET=

# Setup Token (REQUIRED IN PRODUCTION)
# Protects the /setup endpoint from unauthorized webhook registration
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
# Example: a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8a9b0c1d2e3f4a5b6c7d8e9f0a1b2
SETUP_TOKEN=

# Allowed Telegram User IDs (REQUIRED IN PRODUCTION)
# Comma-separated list of Telegram user IDs allowed to use the bot
# Get your user ID by sending a message to @userinfobot on Telegram
# Example: ALLOWED_USERS=123456789,987654321
ALLOWED_USERS=

# Node environment
# For Railway/production: production (Railway sets this automatically)
# For local/ngrok testing: development (bypasses strict HTTPS requirements)
NODE_ENV=development

# Anthropic Claude API
ANTHROPIC_API_KEY=your_anthropic_api_key
CLAUDE_MODEL=claude-sonnet-4-20250514
CLAUDE_MAX_TOKENS=16000
# Extended thinking (ultrathink) - Set to 'true' to enable deep reasoning for complex nutrition analysis
CLAUDE_EXTENDED_THINKING=true
CLAUDE_THINKING_BUDGET=10000

# GitHub Configuration
GITHUB_TOKEN=your_github_personal_access_token
GITHUB_OWNER=tmustier
GITHUB_REPO=nutrition-tracking
# For testing: daily-logs-test
# For production: daily-logs
GITHUB_BRANCH=daily-logs-test

# ==============================================================================
# USDA FOODDATA CENTRAL API
# ==============================================================================

# USDA API Key (RECOMMENDED IN PRODUCTION)
# Get free API key from: https://fdc.nal.usda.gov/api-key-signup.html
# If not set, will fall back to DEMO_KEY (limited to ~1000 requests/hour)
# Production deployments should use a dedicated API key
USDA_API_KEY=

# ==============================================================================
# SECURITY REQUIREMENTS SUMMARY
# ==============================================================================
#
# PRODUCTION REQUIREMENTS (bot will fail to start if missing):
#   ✓ TELEGRAM_BOT_TOKEN - Your production bot token from @BotFather
#   ✓ WEBHOOK_SECRET - 64-character hex string for webhook verification
#   ✓ SETUP_TOKEN - 64-character hex string for /setup endpoint protection
#   ✓ ALLOWED_USERS - Comma-separated Telegram user IDs
#   ✓ WEBHOOK_URL - Must use HTTPS (HTTP rejected in production)
#   ✓ GITHUB_BRANCH - Must be 'daily-logs' in production
#
# GENERATE SECRETS:
#   Run this command twice to generate WEBHOOK_SECRET and SETUP_TOKEN:
#   node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
#
# GET YOUR TELEGRAM USER ID:
#   Send any message to @userinfobot on Telegram
#
# DEVELOPMENT MODE:
#   - WEBHOOK_SECRET: Optional but recommended for realistic testing
#   - SETUP_TOKEN: Optional (allows unauthenticated /setup)
#   - ALLOWED_USERS: Optional (allows all users if not set)
#   - WEBHOOK_URL: Can use HTTP (HTTPS not enforced)
#
#   If WEBHOOK_SECRET is not set in development, you must explicitly opt-in:
#   ALLOW_UNVERIFIED_WEBHOOK=true
#
# ==============================================================================

# Development-only: Allow unverified webhooks (NOT recommended)
# Only set this if you're testing locally without WEBHOOK_SECRET
# NEVER set this in production
# ALLOW_UNVERIFIED_WEBHOOK=true
